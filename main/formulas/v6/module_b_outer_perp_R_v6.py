# -*- coding: utf-8 -*-
"""

============================================================
ğŸ­ B å·¥å» ï¼šå¤–å¾‘æ¥æ–œè§’.äº¤é»å€’rè§’(æ¨¡ç‰ˆ)

============================================================
"""

import math


def solve_b(data):


    # ==================================================
    # 1ï¸âƒ£ è®€å–ä¸¦æ•´ç†è¼¸å…¥ï¼ˆå°é½Š Excel B ç³»åˆ—ï¼‰
    # --------------------------------------------------
    # èªªæ˜ï¼š
    # - æ‰€æœ‰è¼¸å…¥çš†è½‰ç‚º float
    # - å¤–å¾‘ä¸€å¾‹è½‰ç‚ºåŠå¾‘è¨ˆç®—
    # ==================================================
    B2  = float(data["å°å¾‘X"]) / 2.0  # å°å¾‘X
    B3  = -abs(float(data["åŸé»è‡³çµ‚é»é¢W"]) )     # Zè»¸åŸé»è‡³åœ“å­¤èµ·å§‹è·é›¢
    B4  = float(data["è§’åº¦2"]) # æ–œåº¦è§’
    B6  = float(data["çµ‚ç«¯R1"])
    B7  = float(data["åˆ€é¼»åŠå¾‘"]) *2  # åˆ€é¼»ç›´å¾‘
    
    
     # ===== ä¸­é–“é‡ï¼ˆå®Œå…¨ç­‰åƒ¹ Excelï¼‰=====
    B10 = B7 / 2.0                            # =B7/2
    B11 = -1.0 / math.tan(math.radians(B4))   # =-1/TAN(RADIANS(B4))
    B12 = B3 - B11 * B2                        # =B3 - B11*B2
    B13 = math.sqrt(1.0 + B11**2)              # =SQRT(1+B11^2)
    B14 = B2 + B6                              # =B2 + B6
    B15 = B11*B14 + B12 + B6*B13               # =B11*B14 + B12 + B6*B13
    B16 = B6 - B10                             # =B6 - B10 (ä¹Ÿå°±æ˜¯ E9)
    B23 = B12 + B10*B13                        # =B12 + B10*B13
    B24 = 1.0 + B11**2                         # =1 + B11^2
    B25 = 2.0 * ( B11*(B23 - B15) - B14 )      # =2*( B11*(B23 - B15) - B14 )
    B26 = B14**2 + (B23 - B15)**2 - B16**2     # =B14^2 + (B23 - B15)^2 - B16^2

    # B27 = -B25/(2*B24)
    B27 = -B25 / (2.0 * B24)

    # B28 = B11*B27 + B23
    B28 = B11*B27 + B23

    # ===== è¼¸å‡ºï¼ˆå°æ‡‰ Excel æ¬„ä½ï¼‰=====
    E3 = B15        # =B19
    E4 = B2 + B10   # =B20 (= B2 + B10)
    E6 = B28        # =B28
    E7 = B27        # =B27
    E9 = B6 - B10   # =B6 - B10 (åŒ B16)

    B52=E3-B10
    B51=(E4-B10)*2
    B53=E6-B10
    B54=(E7-B10)*2
    B55=E9



    def _fmt(x):
     # ä¾‹å¦‚å›ºå®šé¡¯ç¤ºåˆ°å°æ•¸é»å…©ä½
        return f"{x:.3f}"

 

    result_values = {
         "B51": B51,
         "B52": B52,
         "B53": B53,
         "B54": B54,
         "B55": B55,
      
     }

    text_lines = [
        "â¡ï¸ å‰ç«¯æ–œè§’ â†’ å¹³ç·š â†’ çµ‚é»å¼§ï¼ˆC å·¥å» ï¼‰",
        f"B51 = {_fmt(B51)}",
        f"B52 = {_fmt(B52)}",
        f"B53 = {_fmt(B53)}",
        f"B54 = {_fmt(B54)}",
        f"B55 = {_fmt(B55)}",
      
    ]

    return {
        "ok": True,
        "text_lines": text_lines,
        "values": result_values,
    }


# -------------------------------------------------------
# ğŸ” å°å¤–çµ±ä¸€ä»‹é¢
# -------------------------------------------------------
def solve(data: dict):
    return solve_b(data)