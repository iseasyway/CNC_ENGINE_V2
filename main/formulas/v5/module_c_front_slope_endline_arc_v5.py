# -*- coding: utf-8 -*-
"""
module_c_front_slope_endline_arc_v1.py
============================================================
ğŸ­ C å·¥å» ï¼šå‰ç«¯æ–œè§’ â†’ çµ‚é»å¹³ç·š â†’ çµ‚é»åœ“å¼§ï¼ˆV1ï¼‰

è§’è‰²å®šä½ï¼š
- æ‰¿æ¥ A å·¥å» çš„ã€Œå‰ç«¯å¹¾ä½•åŸºæº–ã€
- è¨ˆç®—æ–œç·š â†’ å¹³ç·š â†’ çµ‚é» R åœ“å¼§ çš„å®Œæ•´éŠœæ¥
- å±¬æ–¼ V1 ç³»çµ±ä¸­ã€Œå¹¾ä½•é—œä¿‚æœ€è¤‡é›œã€çš„æ¨¡çµ„

è³‡æ–™ä¾è³´ï¼š
- å¿…é ˆç”± A å·¥å» å…ˆè¡Œè¨ˆç®—
- ä½¿ç”¨ A å·¥å» è¼¸å‡ºçš„ B7ï¼ˆå°å¾‘ X èµ·é»ï¼‰

è¼¸å‡ºï¼š
- E2 ~ E6ï¼šå°é½Š Excel / åŠ å·¥åœ–é¢çš„é—œéµåº§æ¨™èˆ‡åŠå¾‘
- çµ±ä¸€èˆªæ¯æ ¼å¼ï¼ˆvalues + text_linesï¼‰
============================================================
"""

import math


# -------------------------------------------------------
# ğŸ”§ é¡¯ç¤ºç”¨æ ¼å¼åŒ–å·¥å…·
# -------------------------------------------------------


# -------------------------------------------------------
# ğŸ§  æ ¸å¿ƒè¨ˆç®—ï¼ˆC å·¥å» ï¼‰
# -------------------------------------------------------
def solve_c(data):

  
    # ===================================================
    # 1ï¸âƒ£ è®€å–ä¸¦æ•´ç†è¼¸å…¥ï¼ˆå°é½Š Excel B æ¬„ï¼‰
    # ===================================================
    B2  = float(data["å°å¾‘X"]) / 2.0
    B3  = -abs(float(data["å·¥ä»¶åŸé»è‡³çµ‚é»é¢W"]) )
    B5  = float(data["çµ‚ç«¯Rè§’"])
    B6  = float(data["åˆ€é¼»åŠå¾‘"])
   
  
    # ===== è¼¸å‡ºå°æ‡‰ =====
    B9 = B6 
    E3 = B3 + B5        # =B17
    E4 = B2 + B9        # =B14
    E6 = B3 + B9        # =B21
    E7 = B2 + B5        # =B20
    E9 = B5 - B9        # =B5 - B9

    B52=E3-B9
    B51=(E4-B9)*2
    B53=E6-B9
    B54=(E7-B9)*2
    B55=E9
   

    def _fmt(x):
        # ä¾‹å¦‚å›ºå®šé¡¯ç¤ºåˆ°å°æ•¸é»å…©ä½
        return f"{x:.3f}"              
    
    result_values = {
         "B51": B51,
         "B52": B52,
         "B53": B53,
         "B54": B54,
         "B55": B55,
     }

    text_lines = [
        "â¡ï¸ å‰ç«¯æ–œè§’ â†’ å¹³ç·š â†’ çµ‚é»å¼§ï¼ˆC å·¥å» ï¼‰",
        f"B51 = {_fmt(B51)}",
        f"B52 = {_fmt(B52)}",
        f"B53 = {_fmt(B53)}",
        f"B54 = {_fmt(B54)}",
        f"B55 = {_fmt(B55)}",
    ]

    return {
        "ok": True,
        "text_lines": text_lines,
        "values": result_values,
    }


# -------------------------------------------------------
# ğŸ” å°å¤–çµ±ä¸€ä»‹é¢
# -------------------------------------------------------
def solve(data: dict):
    return solve_c(data)